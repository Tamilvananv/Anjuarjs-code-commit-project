 <div class="row">
  <div class="col-lg-12">
    <div class="card">
      <div class="d-flex no-block align-items-center" *ngIf="PageAccessRight.HasWriteAccess">
        <h4 class="card-title"></h4>
        <div class="ml-auto mb-2" style="padding-top: 28px ;">
          <button class="addbtn_style" ejs-button [routerLink]="['addinstrument']">
            <i class="fas fa-plus-circle"></i> &nbsp;&nbsp;Add Instrument
          </button>
        </div>
      </div>
       <div *ngIf="!PageAccessRight.HasWriteAccess"><br /> <br /></div>
      <div class="table-responsive" >
        <ejs-grid #grid id="Grid" [dataSource]="objIcsList" [allowSelection]="true" allowFiltering="true"
          [filterSettings]="filterOptions" [allowExcelExport]="true" [gridLines]="lines" [enableHover]="false"
          [allowSorting]="true" e-gridheader="" height="363px"  [pageSettings]='pageSettings'
          (toolbarClick)='toolbarClick($event)'[toolbar]='toolbarOptions'[toolbar]='toolbar'[textWrapSettings]='wrapSettings' allowTextWrap='true'
          (commandClick)="commandClick($event)" allowPaging='true' [showColumnMenu]="true" [allowGrouping]="true"  (excelExportComplete)='excelExportComplete()'
          (pdfHeaderQueryCellInfo)='pdfHeaderQueryCellInfo($event)' [allowPdfExport]="true"
          (created)="created($event)"  >
          <e-columns>
            <e-column headerText="Action" textAlign="center"  width="70" [commands]="commands">
            </e-column>
            <e-column field="InstrumentId" headerText="Instrument Id" headerTextAlign='center' textAlign='left' format="C2"
              width="130"></e-column>
            <e-column field="InstrumentTypeName" headerText="Instrument Name" headerTextAlign='center' textAlign='left' format="yMd"
              width="160"></e-column>
            <e-column field="InstrumentMake" headerText="Manufacturer"headerTextAlign='center' textAlign='left' width="150"></e-column>
            <e-column field="InstrumentModel" headerText="Model" headerTextAlign='center' textAlign='left' width="100"></e-column>
            <e-column headerText="Availability" textAlign="center" width="100">
              <ng-template #template let-data>
                <div class="loc">
                  <ejs-switch onLabel="ON" offLabel="OFF" [(ngModel)]="data.Availability" aria-checked
                    (click)="  SetAvailabilty($event, data.IcsInstrumentId,data.Availability,Reason) "></ejs-switch>
                </div>
              </ng-template>
            </e-column>
            <e-column  headerText="Qualification" textAlign="center" width="130">
              <ng-template #template let-data>
                  <div><a (click)="openModal(content4);setRowId(data,'Qualification');"><i [ngClass]="(data.HasQualificationAttachment===true)?'far fa-folder-open':'far fa-folder'"></i></a></div>
              </ng-template>
            </e-column>
            <e-column  headerText="URS No" textAlign="center" width="100">
              <ng-template #template let-data>
                  <div><a (click)="openModal(content4);setRowId(data,'URS');"><i [ngClass]="(data.HasURSAttachment===true)?'far fa-folder-open':'far fa-folder'"></i></a></div>
              </ng-template>
            </e-column>
            <e-column  headerText="PO No" textAlign="center" width="100">
              <ng-template #template let-data>
                  <div><a (click)="openModal(content4);setRowId(data,'PO');"><i [ngClass]="(data.HasPOAttachment===true)?'far fa-folder-open':'far fa-folder'"></i></a></div>
              </ng-template>
            </e-column>
            <e-column field="InstrumentDeliveryDate" headerText="Delivery Date" headerTextAlign='center' textAlign='left' [format]='Dateformat' [filter]='filter' width="130">
            </e-column>
            <e-column field="InstrumentMfgSrNo" headerText="Manufacturers Sr No" headerTextAlign='center' textAlign='left' format="C2"
              width="170"></e-column>
            <e-column field="StorageLocationName" headerText=" Location" headerTextAlign='center' textAlign='left' format="C2" width="100">
            </e-column>
            <e-column field="DepartmentName" headerText=" Department Name" headerTextAlign='center' textAlign='left' format="C2" width="160">
            </e-column>
          </e-columns>
        </ejs-grid>
      </div>
      <ng-template #Reason let-modal>
        <div class="modal_header">
          <h5 class="modal-title">Reason</h5>
          <button type="button" class="close" aria-label="close" (click)="CloseAvailability()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form [formGroup]='IcsAvailabilityForm'>
            <div class="row">
              <div class="col-md-12" style="margin-top: 10px;">
                <div class="row">
                  <div class="col-md-3">
                    <div class="col-md-12">
                      <label for="AvailabilityReason" class="control-label col-form-label">Reason :</label>
                      <span class="text-danger">*</span>
                    </div>
                  </div>
                  <div class="col-md-9">
                    <div class="col-md-12" print-error [control]="IcsAvailabilityForm.get('IcsUnAvailabilityReason')">
                      <textarea class="form-control frm_tabtxtarea cye-lf-tag"
                         formControlName="IcsUnAvailabilityReason" name="IcsUnAvailabilityReason"
                        rows="5" ></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="addmodal_style" (click)='SaveAvailability()' ejs-button>  Add </button>
          <button class="cancel_style" (click)="CloseAvailability()" ejs-button>  cancel  </button>
        </div>
      </ng-template>
     </div>
  </div>
</div>

<ng-template #content4 let-modal>
  <div class="modal_header">
    <div class="col-md-12">
        <div class="row">
          <div class="col-md-6">
              <h5 class="modal-title">Attachments</h5>
          </div>
          <div class="col-md-6" class="Close_Popup">
            <i class="fas fa-times" (click)="modal.dismiss('Cross click')"></i>
          </div>

        </div>
      </div>
  </div>
  <div class="modal-body">
    <ejs-filemanager id='overview' #fileManagerCtrl [ajaxSettings]='ajaxSettings' [searchSettings]='searchSettings' (beforeDownload)="beforeSend($event)"
        (beforeImageLoad)="beforeSend($event)" [rootAliasName]="'Attachments'" (beforeSend)="beforeSend($event)"  [contextMenuSettings]='contextMenuSettings' [toolbarSettings]='toolbarSettings' view='Details'>
    </ejs-filemanager>
  </div>
</ng-template>
