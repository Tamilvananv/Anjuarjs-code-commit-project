<div class="row" style="padding-top: 28px;">
  <div class="col-md-6 text-left">
    <div class="row" style="padding-left: 5px;">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-4">
            <label for="ChangeControlNumber">Change Control Number:</label>
          </div>
          <div class="col-md-7">
            {{ ChangeControlNumber }}
          </div>
        </div>
      </div>

    </div>
  </div>
  <div class="col-md-6 text-right">

    <div class="custom-control " style="padding-bottom: 5px;">
     
      <button type="submit" class="btn_frmsubmit" (click)="moveToTab('tab-requisition-details');" ejs-button>
        Back
      </button>
      <button type="button" class="btn_frmsubmit"  *ngIf="btnNext" (click)="moveToTab('tab-selectbyid3');" ejs-button>
        Next
      </button>
      <button type="button" class="btn_frmcancel" ejs-button>
        Cancel
      </button>
    </div>
  </div>

</div>

<div class="row">
  <div class="col-lg-12">
    <div class="card">
      <div class="d-flex no-block align-items-center">
        <h4 class="card-title"></h4>
        <div class=" mb-2" style="color: black;">
          <!-- <h5>  {{ ChangeControlNumber }}</h5>  -->
        </div>
        <div class="ml-auto mb-2">
          <button class="btn_frmsubmit" (click)="OpenaddparameterModal(addParameterModal)" *ngIf="!IfEditForNotAllowed" ejs-button>
            Add
          </button>
        </div>

      </div>
      <div class="table-responsive">
        <ejs-grid #grid id="Grid" [dataSource]="ObjChangeDetailsList" allowFiltering="true"
          [filterSettings]="filterOptions" [gridLines]="lines" [enableHover]="false" [allowSorting]="true"
          e-gridheader="" height="200px" allowTextWrap='true' [textWrapSettings]='wrapSettings'
          [toolbar]="toolbarOptions" [allowExcelExport]="true" (toolbarClick)="toolbarClick($event)"
          (commandClick)="commandClick($event)">
          <e-columns>
            <e-column headerText="Action" textAlign="center" width="170">
              <div class="col-md-12">
                <div class="row">
                    <div class="col-md-12">
                        <ng-template #template let-data>
                        <div class="row">
                          <div class="col-md-6">
                              <button class="addbtn1_style" [disabled]="IfEditForNotAllowed"  (click)="OpenaddparameterModal(addParameterModal,data)" ejs-button >
                                  <i class="fa fa-edit"></i>   
                                </button>
                          </div>
                          <div class="col-md-6">
                              <button class="addbtn1_style" [disabled]="!IfEditForNotAllowed" (click)="OpenaddparameterModal(addParameterModal,data)" ejs-button >
                                  <i class="fa fa-eye"></i>  
                                </button>
                            </div>
                        </div>
                        </ng-template>
                      </div>
                </div>
              </div>
            </e-column>
           
            <e-column field="EqmsCcProcedure" headerText="Current / Existing System / Procedure" textAlign="center"
              width="300">
            </e-column>
            <e-column field="EqmsCcProposedChange" headerText="Changes Proposed" textAlign="center" width="210">
            </e-column>
            <e-column field="EqmsCcJustification" headerText="Justification for Change" textAlign="center" width="210">
            </e-column>
            <e-column field="EqmsCcActionPlan" headerText="Action Plan" textAlign="center" width="210"></e-column>
            <e-column field="DepartmentName" headerText="Responsible Department" textAlign="center" width="250">
            </e-column>
            <e-column field="Attach" headerText="Attach" textAlign="center" width="210">
              <ng-template #template let-data>
                <div><a (click)="openAddModal(content4);setRowId(data);"><i
                      [ngClass]="(data.EqmsCcAttachment===true)?'far fa-folder-open':'far fa-folder'"></i>
                    <p></p>
                  </a></div>
              </ng-template>
            </e-column>
          </e-columns>
        </ejs-grid>
      </div>
      <div class="col-md-12 text-right">
        <div class="custom-control " style="padding-bottom: 5px;">
          <button type="submit" (click)="clickSignAndSubmit()" *ngIf="!IfEditForNotAllowed" class="btn_frmsubmit" ejs-button>
            Sign and Submit
          </button>

        </div>
      </div>

    </div>
  </div>
</div>
<ng-template #content4 let-modal>
  <div class="modal_header">
    <!-- <h5 class="modal-title">Attachments</h5>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button> -->
    <div class="col-md-12">
      <div class="row">
        <div class="col-md-6">
          <h5 class="modal-title">Attachments</h5>
        </div>
        <div class="col-md-6" class="Close_Popup" (click)="modal.dismiss('Cross click')">
          <i class="fas fa-times"></i>
        </div>

      </div>
    </div>
  </div>
  <div class="modal-body">

    <ejs-filemanager id='overview' #fileManagerCtrl [ajaxSettings]='ajaxSettings' [searchSettings]='searchSettings'
      (beforeDownload)="beforeSend($event)" (beforeImageLoad)="beforeSend($event)" [rootAliasName]="'Attachments'"
      (beforeSend)="beforeSend($event)" [contextMenuSettings]='contextMenuSettings' [toolbarSettings]='toolbarSettings'
      view='Details'>
    </ejs-filemanager>
  </div>
</ng-template>
<ng-template #addParameterModal let-modal>
  <div class="modal_header">
    <div class="col-md-12">
      <div class="row">
        <div class="col-md-6">
          <h5 class="modal-title">Add </h5>
        </div>
        <div class="col-md-6" class="Close_Popup">
          <i class="fas fa-times" (click)="modal.dismiss('Cross click')"></i>
        </div>

      </div>
    </div>

  </div>
  <div class="modal-body">
    <form class="form-horizontal" [formGroup]='EQMSAddChangeDetailsformData'>
      <div class="row">
        <div class="col-md-4">
          <label for="ChangeControlNumber">Change Control Number:</label>
        </div>
        <div class="col-md-7">
          {{ ChangeControlNumber }}
        </div>
      </div>
      <div class="col-md-12 frm_tabpanel">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6">
                <label for="EqmsCcProcedure">Current / Existing System / Procedure:</label>
              </div>
              <div class="col-md-6">
                <textarea name="EqmsCcProcedure" formControlName="EqmsCcProcedure" [readonly]="IfEditForNotAllowed" rows="5"
                  cols="75">Title </textarea>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12 frm_tabpanel">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6">
                <label for="EqmsCcProposedChange">Changes Proposed:</label>
              </div>
              <div class="col-md-6">
                <textarea name="EqmsCcProposedChange" formControlName="EqmsCcProposedChange" [readonly]="IfEditForNotAllowed"
                  rows="5" cols="75">Title </textarea>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12 frm_tabpanel">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6">
                <label for="EqmsCcJustification">Justification for Change:</label>
              </div>
              <div class="col-md-6">
                <textarea formControlName="EqmsCcJustification" name="EqmsCcJustification" rows="5"
                [readonly]="IfEditForNotAllowed" cols="75">Title </textarea>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-12 frm_tabpanel">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6">
                <label for="EqmsCcActionPlan">Action Plan:</label>
              </div>
              <div class="col-md-6">
                <textarea formControlName="EqmsCcActionPlan" name="EqmsCcActionPlan" rows="5"
                [readonly]="IfEditForNotAllowed" cols="75">Title </textarea>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12 frm_tabpanel">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6">
                <label for="ResponsibleDept">Responsible Department:</label>
              </div>
              <div class="col-md-6">
                <ejs-dropdownlist id="Department" [dataSource]="objDepartmentList" [fields]="fields"
                  (filtering)="onFiltering($event)" [popupHeight]="height" [allowFiltering]="true"
                  [placeholder]="watermark" name="DepartmentId" formControlName="DepartmentId"
                  [readonly]="IfEditForNotAllowed">
                </ejs-dropdownlist>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6">
                <label for="Attach">Attach:</label>
              </div>
              <div class="col-md-6"  >
                <ejs-uploader #defaultupload [autoUpload]="false" [dropArea]="dropEle" [asyncSettings]="path"
                  (success)="onUploadSuccess($event)" (failure)="onUploadFailure($event)"
                  (selected)="onFileSelect($event)" *ngIf="!IfEditForNotAllowed" formArrayName='AttachmentList'></ejs-uploader>
                  
                  <button type="button" *ngIf="IfEditForNotAllowed" (click)="openAddModal(content4)" class="btn_frmcancel"
                  ejs-button>
                  View Attachment
                </button>
              </div>
            
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button class="addmodal_style" (click)="addEqmsChangeDetails()" *ngIf="!IfEditForNotAllowed" ejs-button>
      Save
    </button>

    <button class="cancel_style" (click)="modal.close('Close click')" ejs-button>
      cancel
    </button>
  </div>

</ng-template>